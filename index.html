<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Boarding - Hanwha Style Finance App</title>
    <style>
        /* ====================================
           1. Hanwha Style Color Palette & Basic Setup
           ==================================== */
        :root {
            --primary-color: #F37321; 
            --secondary-color: #231F20; 
            --background-color: #F8F9FA;
            --card-background: #FFFFFF;
            --text-color: #222222;
            --sub-text-color: #888888;
            --card-gradient: linear-gradient(135deg, #FF9966, #FF5E62); 
            --tab-color-active: #F37321;
            --button-bg-soft: #FFF0E6;
            --income-color: #F37321; 
            --expense-color: #222222;
        }

        * { box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            padding-bottom: 80px; 
            -webkit-tap-highlight-color: transparent;
        }

        /* Ïï± ÍªçÎç∞Í∏∞ */
        .app-shell {
            max-width: 450px;
            margin: 0 auto;
            background-color: var(--card-background);
            min-height: 100vh;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.05);
            position: relative;
            padding-bottom: 90px;
            overflow-x: hidden; 
        }

        .page { display: none; padding: 20px; }
        .page.active { display: block; }

        .hidden { display: none !important; }
        .disabled-area { opacity: 0.4; pointer-events: none; }
        
        /* ====================================
           Top Bar
           ==================================== */
        .topbar {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 20px 20px 0;
        }
        .topbar .profile {
            width: 32px; height: 32px; border-radius: 50%; background-color: #EEEEEE; margin-right: 12px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23555"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>');
            background-repeat: no-repeat; background-position: center; background-size: 70%;
        }
        .topbar .pill {
            background: var(--button-bg-soft); color: var(--primary-color); padding: 8px 14px;
            border-radius: 20px; font-size: 14px; font-weight: 700; cursor: pointer;
        }

        /* ====================================
           Home Page Components
           ==================================== */
        .card-container { padding: 10px 20px; }
        .gradient-card {
            width: 100%; height: 200px; background: var(--card-gradient); border-radius: 20px;
            box-shadow: 0 10px 25px rgba(243, 115, 33, 0.3); padding: 20px; color: white;
            position: relative; margin-bottom: 25px; display: flex; flex-direction: column; justify-content: space-between;
        }
        .gradient-card .card-brand { position: absolute; right: 20px; bottom: 20px; display: flex; }
        .brand-circle { width: 24px; height: 24px; border-radius: 50%; }
        .brand-circle.red { background-color: #EB001B; opacity: 0.8; }
        .brand-circle.yellow { background-color: #F79E1B; opacity: 0.8; margin-left: -10px;}
        .card-chip { width: 35px; height: 25px; background: rgba(255,255,255,0.3); border-radius: 4px; margin-bottom: 10px; }

        .balance-area { text-align: center; margin-bottom: 30px; }
        .balance-area .amount { font-size: 36px; font-weight: 800; color: var(--text-color); letter-spacing: -0.5px; }
        .balance-area .currency { font-size: 14px; font-weight: 600; color: var(--sub-text-color); margin-bottom: 5px; }

        .action-tray { display: flex; justify-content: space-around; margin-bottom: 35px; padding: 0 10px; }
        .action-btn-pill { display: flex; flex-direction: column; align-items: center; font-size: 13px; font-weight: 600; color: var(--text-color); cursor: pointer; gap: 8px; transition: transform 0.1s; }
        .action-btn-pill:active { transform: scale(0.95); }
        .action-btn-pill .icon { width: 48px; height: 48px; border-radius: 16px; background: var(--button-bg-soft); color: var(--primary-color); display: flex; justify-content: center; align-items: center; font-size: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); }

        .quick-actions-grid { padding: 0 20px; }
        .grid-4 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .action-card { border-radius: 16px; padding: 16px; color: white; height: 110px; display: flex; flex-direction: column; justify-content: space-between; cursor: pointer; transition: transform 0.1s; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05); }
        .action-card:active { transform: scale(0.98); }
        .action-card.primary { background: linear-gradient(135deg, #F37321, #FF9A44); }
        .action-card.secondary { background: linear-gradient(135deg, #5D5D5D, #333333); }
        .action-card.accent { background: linear-gradient(135deg, #FFC107, #FF9800); }
        .action-card.info { background: linear-gradient(135deg, #4DB6AC, #009688); }

        /* ====================================
           Navigation Bar
           ==================================== */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; right: 0; max-width: 450px; margin: 0 auto;
            height: 70px; background: var(--card-background); display: flex; justify-content: space-around; align-items: center;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.03); z-index: 10; border-top: 1px solid #f0f0f0;
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; font-size: 11px; font-weight: 600; color: #BBBBBB; cursor: pointer; padding: 5px; transition: color 0.2s; }
        .nav-item.active { color: var(--tab-color-active); }
        .nav-item i { font-size: 22px; margin-bottom: 4px; }

        /* ====================================
           Page Styles
           ==================================== */
        .form-card { padding: 20px; background: white; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.03); }
        .back-link { display: inline-flex; align-items: center; gap: 6px; font-weight: 700; color: var(--text-color); cursor: pointer; margin-bottom: 15px; font-size: 14px; opacity: 0.7; text-decoration: none;}
        .back-link:hover { opacity: 1; color: var(--primary-color); }

        /* --- ÎÇ¥Ïó≠(History) Ïä§ÌÉÄÏùº + ÌïÑÌÑ∞ --- */
        .history-search {
            width: 100%; padding: 12px 15px; border-radius: 20px; border: 1px solid #eee; background: #f5f5f5; 
            font-size: 14px; margin-bottom: 15px; outline: none;
        }
        .history-search:focus { border-color: var(--primary-color); background: #fff; }

        .filter-container {
            display: flex; align-items: center; width: 100%; margin-bottom: 20px; gap: 8px;
        }
        .filter-scroll-area {
            flex: 1; display: flex; gap: 8px; overflow-x: auto; padding: 4px 0;
            -ms-overflow-style: none; scrollbar-width: none;
            align-items: center; 
        }
        .filter-scroll-area::-webkit-scrollbar { display: none; }
        
        .filter-pill {
            padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; 
            background: #fff; border: 1px solid #eee; color: #666; white-space: nowrap; cursor: pointer; transition: all 0.2s;
            height: 36px; display: flex; align-items: center; 
        }
        .filter-pill.active {
            background: var(--button-bg-soft); color: var(--primary-color); border-color: var(--primary-color);
        }
        
        .filter-reset-btn {
            flex-shrink: 0; width: 36px; height: 36px; border-radius: 50%; border: 1px solid #eee; background: #fff;
            display: flex; align-items: center; justify-content: center; color: #666; cursor: pointer;
            box-shadow: -2px 0 5px rgba(0,0,0,0.03); margin-left: auto;
        }
        .filter-reset-btn:active { background: #f0f0f0; }

        .history-month-header {
            font-size: 13px; color: var(--sub-text-color); margin-bottom: 15px; margin-top: 10px; font-weight: 600;
        }
        .transaction-list {
            list-style: none; padding: 0; margin: 0;
        }
        .transaction-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 18px 0; border-bottom: 1px solid #f5f5f5; cursor: pointer;
        }
        .transaction-item:active { background-color: #f9f9f9; }

        .t-left { display: flex; align-items: center; gap: 15px; }
        
        .t-avatar { 
            width: 48px; height: 48px; border-radius: 50%; background-color: #eee;
            display: flex; align-items: center; justify-content: center; font-weight: 700; color: #555; font-size: 18px;
            position: relative; background-size: cover; background-position: center; flex-shrink: 0;
        }
        .t-info { display: flex; flex-direction: column; gap: 4px; }
        .t-title { font-size: 16px; font-weight: 700; color: var(--text-color); display: flex; align-items: center; gap: 5px; }
        .t-date { font-size: 12px; color: var(--sub-text-color); }
        
        .t-right { text-align: right; display: flex; flex-direction: column; gap: 4px; }
        .t-amount { font-size: 16px; font-weight: 700; color: var(--expense-color); }
        .t-amount.income { color: var(--income-color); } 
        .t-status { font-size: 11px; color: var(--sub-text-color); font-weight: 500; }

        .badge-nexus {
            position: absolute; bottom: -2px; right: -2px; background: var(--primary-color); color: white;
            font-size: 9px; padding: 2px 4px; border-radius: 6px; border: 2px solid white;
        }

        /* --- [NEW] Apple Pay Badge Style --- */
        .apple-pay-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #333;
            border-radius: 4px;
            padding: 0 4px;
            height: 18px;
            gap: 2px;
            vertical-align: middle;
            margin-left: 6px;
            color: #333;
            background-color: #fff;
        }
        .apple-pay-badge i {
            font-size: 12px;
        }
        .apple-pay-badge span {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
            font-weight: 600;
            font-size: 11px;
            line-height: 1;
            position: relative;
            top: 1px;
        }

        /* --- [NEW] Transaction Details Page --- */
        .detail-header { text-align: center; margin-bottom: 25px; margin-top: 10px; }
        .detail-amount { font-size: 36px; font-weight: 800; color: var(--text-color); margin-bottom: 8px; }
        .detail-title { font-size: 18px; color: #555; font-weight: 600; }
        
        .detail-box-label {
            font-size: 11px; color: #aaa; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 700;
            margin-bottom: 15px;
        }

        .detail-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 18px 0; border-bottom: 1px solid #f5f5f5; font-size: 15px;
        }
        .detail-label { color: #888; font-weight: 600; width: 80px; }
        .detail-val { font-weight: 700; color: #333; flex: 1; text-align: right; }
        
        .cat-edit-btn {
            background: #f0f0f0; padding: 6px 12px; border-radius: 15px; font-size: 12px; 
            margin-left: 10px; cursor: pointer; color: #555; display: inline-block;
        }

        .payment-method-box {
            display: inline-flex; align-items: center; gap: 8px; font-weight: 700;
        }
        .pm-card-icon {
            width: 20px; height: 14px; background: var(--primary-color); border-radius: 3px; display: inline-block;
        }
        .pm-apple-icon { font-size: 18px; color: #000; }

        .note-add-link {
            color: var(--primary-color); font-weight: 700; text-decoration: underline; cursor: pointer;
        }
        .note-content { color: #333; }

        .split-btn-container {
            margin-top: 40px; display: flex; justify-content: center;
        }
        .split-btn {
            background: #fff; border: 1px solid #ddd; padding: 12px 25px; border-radius: 30px;
            display: flex; align-items: center; gap: 10px; font-weight: 700; color: #333;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); cursor: pointer;
        }
        .split-avatars { display: flex; margin-right: 5px; }
        .split-avatar { 
            width: 24px; height: 24px; border-radius: 50%; background: #eee; border: 2px solid #fff; 
            margin-left: -8px; display: flex; align-items: center; justify-content: center; font-size: 10px;
        }
        .split-avatar:first-child { margin-left: 0; }

        /* --- Bottom Sheet (Category & Note) --- */
        .bottom-sheet-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5); z-index: 100; display: none; opacity: 0; transition: opacity 0.3s;
        }
        .bottom-sheet {
            position: fixed; bottom: 0; left: 0; right: 0; max-width: 450px; margin: 0 auto;
            background: white; border-radius: 20px 20px 0 0; padding: 25px 20px 40px;
            z-index: 101; transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .bottom-sheet.open { transform: translateY(0); }
        .sheet-title { font-size: 18px; font-weight: 700; margin-bottom: 20px; text-align: center; }
        .sheet-option {
            padding: 15px; border-bottom: 1px solid #f0f0f0; font-size: 16px; font-weight: 600; color: #333;
            display: flex; justify-content: space-between; align-items: center; cursor: pointer;
        }
        .sheet-option:last-child { border-bottom: none; }
        .sheet-option:active { background: #f9f9f9; }
        .sheet-option i { color: var(--sub-text-color); }

        .note-input-wrapper { display: flex; gap: 10px; }
        .note-input {
            flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 12px; font-size: 15px; outline: none;
        }
        .note-input:focus { border-color: var(--primary-color); }

        /* --- Ï∂©Ï†ÑÌïòÍ∏∞ Ïä§ÌÉÄÏùº --- */
        .currency-choice-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .currency-choice { padding: 10px; border: 1px solid #e5e7eb; border-radius: 10px; cursor: pointer; font-weight: 700; text-align: center; background: #fff; display: flex; flex-direction: column; align-items: center; gap: 3px; font-size: 12px; transition: all 0.2s; }
        .currency-choice.active { border-color: var(--primary-color); background-color: var(--button-bg-soft); color: var(--primary-color); box-shadow: 0 2px 8px rgba(243, 115, 33, 0.15); }
        
        .dual-currency { 
            display: flex; align-items: center; gap: 10px; padding: 12px; 
            border-radius: 12px; background: #F8F9FA; margin-bottom: 15px; border: 1px solid #EEEEEE; 
        }
        .currency-box { 
            flex: 1; padding: 10px; border-radius: 10px; 
            transition: all 0.2s; border: 1px solid transparent; 
        }
        .currency-box.active-input {
            background-color: #fff;
            border-color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(243, 115, 33, 0.1);
        }
        .swap-arrow { color: var(--primary-color); font-size: 18px; padding: 0 5px; }

        .currency-box input { width: 100%; border: none; background: transparent; font-size: 22px; font-weight: 800; outline: none; text-align: right; margin-top: 5px; color: var(--text-color); }
        .currency-box input[type="number"] { -moz-appearance: textfield; }
        .currency-box input[type="number"]::-webkit-outer-spin-button, 
        .currency-box input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .currency-box input::placeholder { color: #ccc; font-weight: 400; font-size: 18px; }
        .currency-box input[readonly] { color: var(--primary-color); } 
        .currency-box small { font-size: 12px; color: var(--sub-text-color); display: block; }

        .money-grid { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 8px; margin-bottom: 20px; }
        .money-btn { width: 31%; padding: 12px 0; background-color: #f5f5f5; border: none; border-radius: 8px; font-size: 13px; font-weight: 600; color: #333; cursor: pointer; transition: background 0.2s; }
        .money-btn:active { background-color: #e0e0e0; }

        .action-row { display: flex; gap: 10px; margin-top: 10px; }
        .btn-reset { flex: 1; background: #fff; border: 1px solid #ddd; color: #666; padding: 14px; border-radius: 12px; font-weight: 700; cursor: pointer; }
        .btn-next { flex: 2; background: var(--primary-color); border: none; color: white; padding: 14px; border-radius: 12px; font-weight: 700; cursor: pointer; }

        .payment-section { margin-top: 20px; }
        .section-title { font-size: 16px; font-weight: 700; margin-bottom: 15px; display: block; }
        .payment-option { display: flex; align-items: center; padding: 15px 0; border-bottom: 1px solid #eee; cursor: pointer; font-size: 15px;}
        .payment-option.selected { background-color: #fffaf5; }
        .payment-option.selected .radio-circle { border-color: var(--primary-color); }
        .payment-option.selected .radio-circle::after { content: ''; width: 10px; height: 10px; background: var(--primary-color); border-radius: 50%; }
        .radio-circle { width: 20px; height: 20px; border: 2px solid #ccc; border-radius: 50%; margin-right: 15px; display: flex; align-items: center; justify-content: center; }
        
        .detail-box { margin-top: 10px; padding: 15px; background: #f9f9f9; border-radius: 10px; border: 1px solid #eee; display: none; }
        .detail-box.show { display: block; animation: fadeIn 0.3s; }

        .saved-card-list { margin-top: 5px; }
        .saved-card-item { display: flex; align-items: center; padding: 10px; border: 1px solid #eee; border-radius: 8px; margin-bottom: 8px; background: #fff; cursor: pointer; }
        .saved-card-item.active { border-color: var(--primary-color); background-color: #fff0e6; }
        .saved-card-item input { margin-right: 10px; accent-color: var(--primary-color); }
        .saved-card-info { font-size: 14px; font-weight: 600; color: #333; }
        .saved-card-sub { font-size: 12px; color: #888; }

        /* --- ÏÜ°Í∏àÌïòÍ∏∞ ÌéòÏù¥ÏßÄ Ïä§ÌÉÄÏùº --- */
        .transfer-search {
            width: 100%; padding: 12px 15px; border-radius: 20px; border: 1px solid #eee; background: #f5f5f5; 
            font-size: 14px; margin-bottom: 25px; outline: none;
        }
        .transfer-search:focus { border-color: var(--primary-color); background: #fff; }
        
        .recipient-list { list-style: none; padding: 0; margin: 0; }
        .recipient-item { 
            display: flex; align-items: center; padding: 15px 0; border-bottom: 1px solid #f0f0f0; cursor: pointer; transition: background 0.2s;
        }
        .recipient-item:active { background-color: #f9f9f9; }
        .recipient-avatar { 
            width: 48px; height: 48px; border-radius: 50%; background-color: #eee; margin-right: 15px; 
            display: flex; align-items: center; justify-content: center; font-weight: 700; color: #555; font-size: 18px;
            position: relative;
        }
        .recipient-info { flex: 1; }
        .recipient-name { font-size: 16px; font-weight: 700; color: var(--text-color); margin-bottom: 4px; }
        .recipient-detail { font-size: 13px; color: var(--sub-text-color); }

        .big-money-input-wrapper {
            background-color: #fff; border: 2px solid var(--primary-color); border-radius: 12px;
            padding: 15px; margin: 20px 0; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 12px rgba(243, 115, 33, 0.1);
        }
        .big-money-input {
            width: 100%; border: none; background: transparent; font-size: 32px; font-weight: 800;
            outline: none; text-align: center; color: var(--text-color);
        }
        .big-money-input::placeholder { color: #ccc; }
        .big-money-input[type="number"] { -moz-appearance: textfield; }
        .big-money-input[type="number"]::-webkit-outer-spin-button, 
        .big-money-input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

        /* --- [NEW] ÎπÑÎ∞ÄÎ≤àÌò∏ ÏûÖÎ†• (PIN) ÌéòÏù¥ÏßÄ --- */
        .pin-container { text-align: center; margin-top: 30px; }
        .pin-message { font-size: 18px; font-weight: 700; margin-bottom: 30px; line-height: 1.4; color: #333; }
        .pin-display { display: flex; justify-content: center; gap: 15px; margin-bottom: 50px; }
        .pin-dot { width: 16px; height: 16px; border-radius: 50%; background-color: #ddd; transition: all 0.2s; }
        .pin-dot.filled { background-color: #333; transform: scale(1.2); }

        /* Î≥¥Ïïà ÌÇ§Ìå®Îìú Ïä§ÌÉÄÏùº */
        .num-pad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; padding: 0 20px; max-width: 350px; margin: 0 auto; }
        .num-key { 
            padding: 20px 0; font-size: 24px; font-weight: 600; color: #333; text-align: center; 
            border-radius: 12px; cursor: pointer; user-select: none; transition: background 0.2s;
        }
        .num-key:active { background-color: #f0f0f0; }
        .num-key.empty { cursor: default; }

        /* --- [NEW] ÏôÑÎ£å ÌéòÏù¥ÏßÄ (Success) --- */
        .success-container { text-align: center; padding-top: 40px; }
        .success-icon { 
            width: 80px; height: 80px; background: var(--primary-color); border-radius: 50%; color: white;
            display: flex; align-items: center; justify-content: center; font-size: 40px; margin: 0 auto 20px;
            box-shadow: 0 10px 20px rgba(243, 115, 33, 0.3);
        }
        .success-title { font-size: 24px; font-weight: 800; margin-bottom: 10px; color: var(--text-color); }
        .success-desc { font-size: 16px; color: var(--sub-text-color); margin-bottom: 40px; }
        
        .success-btns { display: flex; gap: 12px; margin-top: 20px; }
        .btn-share { flex: 1; background: #eee; color: #333; font-weight: 700; border: none; padding: 15px; border-radius: 12px; cursor: pointer; }
        .btn-complete { flex: 1; background: var(--primary-color); color: white; font-weight: 700; border: none; padding: 15px; border-radius: 12px; cursor: pointer; }


        /* Bottom Floating Bar */
        .bottom-floating-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            background-color: rgba(243, 115, 33, 0.95);
            padding: 20px; padding-bottom: 30px;
            border-radius: 20px 20px 0 0; text-align: center; color: white; font-size: 18px; font-weight: 700;
            cursor: pointer; z-index: 100;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.1);
            max-width: 450px; margin: 0 auto;
        }

        /* Common Inputs */
        .input-group { margin-bottom: 14px; }
        .input-group label { display: block; font-size: 13px; color: var(--sub-text-color); margin-bottom: 6px; }
        .input-group input, .input-group select { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid #e5e7eb; font-size: 15px; background: #fff; }
        .btn.primary { background: var(--primary-color); color: #fff; border: none; padding: 14px; border-radius: 12px; width: 100%; font-weight: 700; cursor: pointer; box-shadow: 0 4px 12px rgba(243, 115, 33, 0.3); }
        .btn.primary:hover { opacity: 0.95; }
        .toast { position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%); background: #111; color: #fff; padding: 12px 18px; border-radius: 16px; font-size: 14px; display: none; z-index: 200; opacity: 0; transition: opacity 0.3s; box-shadow: 0 8px 20px rgba(0,0,0,0.2); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

<div class="app-shell">
    <div class="topbar">
        <div class="profile"></div>
        <div class="pill" onclick="showToast('ÏïåÎ¶º ÌéòÏù¥ÏßÄ')"><i class="fas fa-bell"></i></div>
    </div>

    <section class="page active" id="page-home">
        <div class="card-container">
            <div class="gradient-card">
                <div>
                    <div class="label" style="opacity:0.8;">Hanwha Travel Card</div>
                    <div class="card-chip"></div>
                    <div class="card-number" style="margin-top:5px; font-size:18px; letter-spacing:1px;">0023 1234 5678 9000</div>
                </div>
                <div>
                    <div class="label" style="font-size:12px; opacity:0.8;">MEMBER SINCE 2024</div>
                    <div class="card-brand">
                        <div class="brand-circle red"></div>
                        <div class="brand-circle yellow"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="balance-area">
            <div class="currency">Ï¥ù ÏûîÏï° (KRW)</div>
            <div class="amount" id="total-assets">‚Ç©5,000,000</div>
        </div>

        <div class="action-tray">
            <div class="action-btn-pill" data-target="page-transfer">
                <div class="icon"><i class="fas fa-paper-plane"></i></div>
                ÏÜ°Í∏à
            </div>
            <div class="action-btn-pill" data-target="page-charge">
                <div class="icon"><i class="fas fa-plus"></i></div>
                Ï∂©Ï†Ñ
            </div>
            <div class="action-btn-pill" onclick="showToast('ÏöîÏ≤≠ Í∏∞Îä• Ï§ÄÎπÑÏ§ë')">
                <div class="icon"><i class="fas fa-hand-holding-usd"></i></div>
                ÏöîÏ≤≠
            </div>
            <div class="action-btn-pill" data-target="page-remit">
                <div class="icon"><i class="fas fa-globe-asia"></i></div>
                ÌôòÏ†Ñ
            </div>
        </div>

        <div class="quick-actions-grid">
            <h3 style="font-size:17px; margin-bottom:15px;">ÏûêÏ£º Ïì∞Îäî Í∏∞Îä•</h3>
            <div class="grid-4">
                <div class="action-card primary" data-target="page-history">
                    <div><i class="fas fa-receipt" style="font-size:24px;"></i></div>
                    <div style="font-size:14px; font-weight:600;">ÏÜåÎπÑ ÎÇ¥Ïó≠</div>
                </div>
                <div class="action-card secondary" data-target="page-cards">
                    <div><i class="fas fa-bus" style="font-size:24px;"></i></div>
                    <div style="font-size:14px; font-weight:600;">ÍµêÌÜµÏπ¥Îìú</div>
                </div>
                <div class="action-card accent" onclick="showToast('ÎØ∏ÏÖò/ÌòúÌÉù ÌôïÏù∏')">
                    <div><i class="fas fa-medal" style="font-size:24px;"></i></div>
                    <div style="font-size:14px; font-weight:600;">ÎØ∏ÏÖò (5,000P)</div>
                </div>
                <div class="action-card info" onclick="showToast('ÎπÑÏûê Í¥ÄÎ¶¨')">
                    <div><i class="fas fa-passport" style="font-size:24px;"></i></div>
                    <div style="font-size:14px; font-weight:600;">ÎπÑÏûê Í¥ÄÎ¶¨</div>
                </div>
            </div>
        </div>
    </section>

    <section class="page" id="page-history">
        <a class="back-link" data-target="page-home"><i class="fas fa-arrow-left"></i> ÌôàÏúºÎ°ú</a>
        
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2 style="margin:10px 0 20px;">Ïù¥Ïö© ÎÇ¥Ïó≠</h2>
            <span style="font-size:14px; color:var(--primary-color); font-weight:600;">Ï†ÑÏ≤¥ Î≥¥Í∏∞</span>
        </div>

        <input type="text" class="history-search" placeholder="Ïù¥Î¶Ñ ÎòêÎäî Í∞ÄÎßπÏ†ê Í≤ÄÏÉâ" onkeyup="filterTransactions(this.value)">

        <div class="filter-container">
            <div class="filter-scroll-area">
                <div class="filter-pill" onclick="applyFilter('income')" id="btn-filter-income">Incoming</div>
                <div class="filter-pill" onclick="applyFilter('expense')" id="btn-filter-expense">Outgoing</div>
                <div class="filter-pill" onclick="toggleSortDate()" id="btn-filter-date">Date <i class="fas fa-sort"></i></div>
                <div class="filter-pill" onclick="openCategorySheet('filter')" id="btn-filter-category">Category</div>
            </div>
            <div class="filter-reset-btn" onclick="resetFilters">
                <i class="fas fa-undo-alt"></i>
            </div>
        </div>

        <div class="history-month-header">ÏµúÍ∑º (RECENT)</div>

        <ul class="transaction-list" id="history-list">
            </ul>
    </section>

    <section class="page" id="page-transaction-detail">
        <a class="back-link" data-target="page-history"><i class="fas fa-arrow-left"></i> Î™©Î°ùÏúºÎ°ú</a>
        
        <div style="padding:10px;">
            <div class="detail-header">
                <div class="detail-amount" id="detail-amount"></div>
                <div class="detail-title" id="detail-title"></div>
            </div>
            
            <div style="background:#fff; border-radius:15px; padding:20px; box-shadow:0 5px 20px rgba(0,0,0,0.03);">
                <div class="detail-box-label">TRANSACTION DETAILS</div>

                <div class="detail-row">
                    <span class="detail-label">Category</span>
                    <div style="display:flex; align-items:center;">
                        <span id="detail-category" class="detail-val"></span>
                        <div class="cat-edit-btn" onclick="openCategorySheet('edit')"><i class="fas fa-pen"></i></div>
                    </div>
                </div>
                <div class="detail-row">
                    <span class="detail-label">When</span>
                    <span id="detail-when" class="detail-val"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Where</span>
                    <span id="detail-where" class="detail-val"></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Paid via</span>
                    <div id="detail-paid-via" class="detail-val"></div>
                </div>
                <div class="detail-row" style="border-bottom:none;">
                    <span class="detail-label">Note</span>
                    <div id="detail-note-area" class="detail-val">
                        </div>
                </div>
            </div>

            <div class="split-btn-container">
                <div class="split-btn" onclick="showToast('ÎçîÏπòÌéòÏù¥ ÏöîÏ≤≠ Ï†ÑÏÜ°Îê®')">
                    <div class="split-avatars">
                        <div class="split-avatar"><i class="fas fa-user"></i></div>
                        <div class="split-avatar"><i class="fas fa-user"></i></div>
                    </div>
                    Split this payment
                </div>
            </div>
        </div>
    </section>

    <div class="bottom-sheet-overlay" id="category-overlay" onclick="closeCategorySheet()"></div>
    <div class="bottom-sheet" id="category-sheet">
        <div class="sheet-title">Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉù</div>
        <div class="sheet-option" onclick="handleCategorySelect('Eating Out')">Eating Out <i class="fas fa-utensils"></i></div>
        <div class="sheet-option" onclick="handleCategorySelect('Groceries')">Groceries <i class="fas fa-shopping-basket"></i></div>
        <div class="sheet-option" onclick="handleCategorySelect('Housing')">Housing <i class="fas fa-home"></i></div>
        <div class="sheet-option" onclick="handleCategorySelect('Shopping')">Shopping <i class="fas fa-shopping-bag"></i></div>
        <div class="sheet-option" onclick="handleCategorySelect('Transport')">Transport <i class="fas fa-bus"></i></div>
        <div class="sheet-option" onclick="handleCategorySelect('Transfer')">Transfer <i class="fas fa-exchange-alt"></i></div>
    </div>

    <div class="bottom-sheet-overlay" id="note-overlay" onclick="closeNoteSheet()"></div>
    <div class="bottom-sheet" id="note-sheet">
        <div class="sheet-title">Î©îÎ™® ÏûÖÎ†•</div>
        <div class="note-input-wrapper">
            <input type="text" id="note-input" class="note-input" maxlength="30" placeholder="Î©îÎ™®Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (30Ïûê Ïù¥ÎÇ¥)">
            <button class="btn primary" style="width:auto; padding:0 20px;" onclick="saveNote()">ÏôÑÎ£å</button>
        </div>
    </div>

    <section class="page" id="page-cards">
        <a class="back-link" data-target="page-home"><i class="fas fa-arrow-left"></i> ÌôàÏúºÎ°ú</a>
        <h2 style="margin-top:0;">ÎÇ¥ Ïπ¥Îìú Í¥ÄÎ¶¨</h2>
        
        <div class="gradient-card" style="height:180px; margin-bottom:20px;">
            <div>
                <div class="label" style="opacity:0.8;">Hanwha Travel Card</div>
                <div class="card-chip"></div>
            </div>
            <div>
                 <div class="card-number" style="font-size:16px;">0023 1234 5678 9000</div>
                 <div class="card-brand" style="bottom:15px; right:15px;">
                    <div class="brand-circle red"></div>
                    <div class="brand-circle yellow"></div>
                </div>
            </div>
        </div>

        <div class="input-group">
            <label>Ïπ¥Îìú Î≥ÑÏπ≠</label>
            <input type="text" value="Î©îÏù∏ Ïó¨Ìñâ Ïπ¥Îìú">
        </div>
        
        <div style="margin-top:20px;">
            <div style="padding:15px; border-bottom:1px solid #eee; display:flex; justify-content:space-between;">
                <span>Ìï¥Ïô∏ Í≤∞Ï†ú Ï∞®Îã®</span>
                <i class="fas fa-toggle-off" style="font-size:24px; color:#ccc;"></i>
            </div>
            <div style="padding:15px; border-bottom:1px solid #eee; display:flex; justify-content:space-between;">
                <span>Ïπ¥Îìú Î∂ÑÏã§ Ïã†Í≥†</span>
                <i class="fas fa-chevron-right" style="color:#ccc;"></i>
            </div>
            <div style="padding:15px; border-bottom:1px solid #eee; display:flex; justify-content:space-between;">
                <span>ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω</span>
                <i class="fas fa-chevron-right" style="color:#ccc;"></i>
            </div>
        </div>
    </section>

    <section class="page" id="page-all">
        <a class="back-link" data-target="page-home"><i class="fas fa-arrow-left"></i> ÌôàÏúºÎ°ú</a>
        <h2 style="margin-top:0;">Ï†ÑÏ≤¥ Î©îÎâ¥</h2>
        
        <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:15px; text-align:center; margin-top:30px;">
            <div style="padding:15px; background:#f9f9f9; border-radius:12px;">
                <i class="fas fa-user-cog" style="font-size:24px; color:#555; margin-bottom:8px;"></i>
                <div style="font-size:12px;">ÎÇ¥ Ï†ïÎ≥¥</div>
            </div>
            <div style="padding:15px; background:#f9f9f9; border-radius:12px;">
                <i class="fas fa-shield-alt" style="font-size:24px; color:#555; margin-bottom:8px;"></i>
                <div style="font-size:12px;">Î≥¥Ïïà/Ïù∏Ï¶ù</div>
            </div>
            <div style="padding:15px; background:#f9f9f9; border-radius:12px;">
                <i class="fas fa-bullhorn" style="font-size:24px; color:#555; margin-bottom:8px;"></i>
                <div style="font-size:12px;">Í≥µÏßÄÏÇ¨Ìï≠</div>
            </div>
            <div style="padding:15px; background:#f9f9f9; border-radius:12px;">
                <i class="fas fa-headset" style="font-size:24px; color:#555; margin-bottom:8px;"></i>
                <div style="font-size:12px;">Í≥†Í∞ùÏÑºÌÑ∞</div>
            </div>
            <div style="padding:15px; background:#f9f9f9; border-radius:12px;">
                <i class="fas fa-cog" style="font-size:24px; color:#555; margin-bottom:8px;"></i>
                <div style="font-size:12px;">ÏÑ§Ï†ï</div>
            </div>
        </div>
    </section>

    <section class="page" id="page-charge">
        <a class="back-link" data-target="page-home"><i class="fas fa-arrow-left"></i> ÌôàÏúºÎ°ú</a>
        
        <div class="form-card">
            <h2 style="margin-top:0;">Ï∂©Ï†ÑÌïòÍ∏∞</h2>
            <p style="color:var(--sub-text-color); margin-top:4px; margin-bottom:20px;">ÏõêÌïòÎäî ÌÜµÌôîÏôÄ Í∏àÏï°ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.</p>

            <div id="step1-area">
                <div class="currency-choice-grid">
                    <div class="currency-choice active" onclick="setCurrency('USD', this)" data-currency="USD">
                        <span style="font-size:18px;">üá∫üá∏</span> USD
                    </div>
                    <div class="currency-choice" onclick="setCurrency('EUR', this)" data-currency="EUR">
                        <span style="font-size:18px;">üá™üá∫</span> EUR
                    </div>
                    <div class="currency-choice" onclick="setCurrency('AUD', this)" data-currency="AUD">
                        <span style="font-size:18px;">üá¶üá∫</span> AUD
                    </div>
                </div>

                <div class="dual-currency">
                    <div class="currency-box active-input">
                        <small>KRW (ÏõêÌôî)</small>
                        <input id="charge-krw-input" type="number" inputmode="numeric" placeholder="10,000 Ïù¥ÏÉÅ" oninput="calculateFromKrw(this.value)">
                    </div>
                    <div class="swap-arrow"><i class="fas fa-exchange-alt"></i></div>
                    <div class="currency-box">
                        <small id="local-currency-label">USD (ÌòÑÏßÄ ÌÜµÌôî)</small>
                        <input id="charge-local-input" type="text" placeholder="0.00" readonly>
                    </div>
                </div>

                <div class="money-grid">
                    <button class="money-btn" onclick="addMoney(10000)">+1Îßå</button>
                    <button class="money-btn" onclick="addMoney(30000)">+3Îßå</button>
                    <button class="money-btn" onclick="addMoney(50000)">+5Îßå</button>
                    <button class="money-btn" onclick="addMoney(100000)">+10Îßå</button>
                    <button class="money-btn" onclick="addMoney(500000)">+50Îßå</button>
                    <button class="money-btn" onclick="addMoney(1000000)">+100Îßå</button>
                </div>

                <div class="action-row" id="charge-action-row">
                    <button class="btn-reset" onclick="resetCharge()">Ï¥àÍ∏∞Ìôî</button>
                    <button class="btn-next" onclick="goNextStep()">Îã§Ïùå</button>
                </div>
            </div>

            <div id="step2-area" class="hidden">
                <div style="height:1px; background:#eee; margin:25px 0;"></div>
                
                <div class="payment-section">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                        <span class="section-title" style="margin:0;">Í≤∞Ï†ú ÏàòÎã® ÏÑ†ÌÉù</span>
                        <span onclick="resetCharge()" style="font-size:13px; color:#999; text-decoration:underline; cursor:pointer;">Í∏àÏï° Ïû¨ÏÑ§Ï†ï</span>
                    </div>

                    <div class="payment-option" onclick="selectMethod(this, 'cash')">
                        <div class="radio-circle"></div> 
                        <span><i class="fas fa-store" style="color:var(--primary-color); margin-right:8px;"></i>Ìé∏ÏùòÏ†ê (ÌòÑÍ∏à)</span>
                    </div>
                    <div id="barcode-detail" class="detail-box">
                        <div style="font-weight:700; margin-bottom:6px; text-align:center;">Ìé∏ÏùòÏ†ê Ï∂©Ï†ÑÏö© Î∞îÏΩîÎìú</div>
                        <div style="text-align:center;">
                            <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='260' height='80'><rect width='260' height='80' fill='white'/><g stroke='black' stroke-width='6'><line x1='15' y1='10' x2='15' y2='70'/><line x1='35' y1='10' x2='35' y2='70'/><line x1='55' y1='10' x2='55' y2='70'/><line x1='80' y1='10' x2='80' y2='70'/><line x1='100' y1='10' x2='100' y2='70'/><line x1='120' y1='10' x2='120' y2='70'/><line x1='145' y1='10' x2='145' y2='70'/><line x1='165' y1='10' x2='165' y2='70'/><line x1='185' y1='10' x2='185' y2='70'/><line x1='205' y1='10' x2='205' y2='70'/><line x1='225' y1='10' x2='225' y2='70'/></g><text x='130' y='60' text-anchor='middle' font-family='monospace' font-size='14'>HANWHA CHARGE</text></svg>" alt="barcode" style="width:100%; max-width:250px; height:auto;">
                        </div>
                        <div style="margin-top:6px; color:var(--sub-text-color); font-size:12px; text-align:center;">Ï†êÏõêÏóêÍ≤å Ïù¥ Î∞îÏΩîÎìúÎ•º Î≥¥Ïó¨Ï£ºÏÑ∏Ïöî.</div>
                    </div>

                    <div class="payment-option" onclick="selectMethod(this, 'card')">
                        <div class="radio-circle"></div> 
                        <span><i class="fas fa-credit-card" style="color:var(--primary-color); margin-right:8px;"></i>Ïã†Ïö©Ïπ¥Îìú / Ï≤¥ÌÅ¨Ïπ¥Îìú</span>
                    </div>
                    
                    <div id="card-detail" class="detail-box">
                        <p style="font-size:13px; color:#666; margin-bottom:10px;">ÏÇ¨Ïö©Ìï† Ïπ¥ÎìúÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</p>
                        <div class="saved-card-list">
                            <label class="saved-card-item" onclick="toggleCardMode('saved')">
                                <input type="radio" name="card_select" value="9334" checked>
                                <div>
                                    <div class="saved-card-info">Mastercard **** 9334</div>
                                    <div class="saved-card-sub">Î≤ïÏù∏Ïπ¥Îìú (ÏùºÏãúÎ∂à)</div>
                                </div>
                            </label>
                            <label class="saved-card-item" onclick="toggleCardMode('saved')">
                                <input type="radio" name="card_select" value="8665">
                                <div>
                                    <div class="saved-card-info">Visa **** 8665</div>
                                    <div class="saved-card-sub">Í∞úÏù∏Ïπ¥Îìú</div>
                                </div>
                            </label>
                            <label class="saved-card-item" onclick="toggleCardMode('new')">
                                <input type="radio" name="card_select" value="new">
                                <div>
                                    <div class="saved-card-info" style="color:var(--primary-color);">+ ÏÉà Ïπ¥Îìú Îì±Î°ù</div>
                                </div>
                            </label>
                        </div>
                        <div id="new-card-form" style="margin-top:15px; border-top:1px dashed #ddd; padding-top:15px; display:none;">
                            <div class="input-group">
                                <label>Ïπ¥Îìú Î≤àÌò∏</label>
                                <input type="text" placeholder="0000 0000 0000 0000" inputmode="numeric" maxlength="19">
                            </div>
                            <div style="display:flex; gap:10px;">
                                <div class="input-group" style="flex:1;">
                                    <label>Ïú†Ìö®Í∏∞Í∞Ñ (MM/YY)</label>
                                    <input type="text" placeholder="12/25" maxlength="5">
                                </div>
                                <div class="input-group" style="flex:1;">
                                    <label>CVC</label>
                                    <input type="password" placeholder="***" maxlength="3" inputmode="numeric">
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>

    <section class="page" id="page-transfer">
        <a class="back-link" data-target="page-home"><i class="fas fa-arrow-left"></i> ÌôàÏúºÎ°ú</a>
        
        <div class="form-card">
            <h2 style="margin-top:0; margin-bottom:20px;">ÏÜ°Í∏àÌïòÍ∏∞</h2>
            
            <div id="transfer-step-1">
                <input type="text" class="transfer-search" placeholder="Í≥ÑÏ¢åÎ≤àÌò∏ÎÇò Ïù¥Î¶Ñ ÏûÖÎ†•">
                
                <h3 style="font-size:15px; margin-bottom:15px; color:#555;">ÏµúÍ∑º Î≥¥ÎÇ∏ Î∂Ñ</h3>
                
                <ul class="recipient-list">
                    <li class="recipient-item" onclick="selectRecipient('Ryan', 'Nexus Friend')">
                        <div class="recipient-avatar">R <span class="badge-nexus">N</span></div>
                        <div class="recipient-info">
                            <div class="recipient-name">Ryan</div>
                            <div class="recipient-detail">Nexus Friend</div>
                        </div>
                        <i class="fas fa-chevron-right" style="color:#ddd;"></i>
                    </li>
                    <li class="recipient-item" onclick="selectRecipient('Bailey', 'Nexus Friend')">
                        <div class="recipient-avatar" style="background:#e3f2fd; color:#1565c0;">B <span class="badge-nexus">N</span></div>
                        <div class="recipient-info">
                            <div class="recipient-name">Bailey</div>
                            <div class="recipient-detail">Nexus Friend</div>
                        </div>
                        <i class="fas fa-chevron-right" style="color:#ddd;"></i>
                    </li>
                    <li class="recipient-item" onclick="selectRecipient('Michael', 'Nexus Friend')">
                        <div class="recipient-avatar" style="background:#f3e5f5; color:#7b1fa2;">M <span class="badge-nexus">N</span></div>
                        <div class="recipient-info">
                            <div class="recipient-name">Michael</div>
                            <div class="recipient-detail">Nexus Friend</div>
                        </div>
                        <i class="fas fa-chevron-right" style="color:#ddd;"></i>
                    </li>
                    <li class="recipient-item" onclick="selectRecipient('Leah', 'Nexus Friend')">
                        <div class="recipient-avatar" style="background:#e8f5e9; color:#2e7d32;">L <span class="badge-nexus">N</span></div>
                        <div class="recipient-info">
                            <div class="recipient-name">Leah</div>
                            <div class="recipient-detail">Nexus Friend</div>
                        </div>
                        <i class="fas fa-chevron-right" style="color:#ddd;"></i>
                    </li>
                    
                    <li class="recipient-item" onclick="selectRecipient('ÌôçÍ∏∏Îèô', 'ÌïòÎÇòÏùÄÌñâ 715-***')">
                        <div class="recipient-avatar" style="background:#009490; color:white;">Ìôç</div>
                        <div class="recipient-info">
                            <div class="recipient-name">ÌôçÍ∏∏Îèô</div>
                            <div class="recipient-detail">ÌïòÎÇòÏùÄÌñâ 71500000000000</div>
                        </div>
                        <i class="fas fa-chevron-right" style="color:#ddd;"></i>
                    </li>
                </ul>
            </div>

            <div id="transfer-step-2" class="hidden">
                <div style="background:#f9f9f9; padding:15px; border-radius:12px; margin-bottom:20px; text-align:center;">
                    <div style="font-size:14px; color:#888;">Î∞õÎäî Î∂Ñ</div>
                    <div id="selected-recipient-name" style="font-size:18px; font-weight:700; color:#333; margin-top:5px;"></div>
                    <div id="selected-recipient-info" style="font-size:13px; color:#666;"></div>
                </div>

                <div style="margin-bottom:6px; font-size:14px; color:#666; text-align:center;">Î≥¥ÎÇº Í∏àÏï°</div>
                
                <div class="big-money-input-wrapper">
                    <input type="number" id="transfer-amount" class="big-money-input" placeholder="0" inputmode="numeric">
                </div>
                
                <div style="display:flex; gap:10px; margin-top:20px;">
                    <button class="btn" style="flex:1; background:#eee; color:#333;" onclick="resetTransfer()">Ï∑®ÏÜå</button>
                    <button class="btn primary" style="flex:2;" onclick="submitTransfer()">Î≥¥ÎÇ¥Í∏∞</button>
                </div>
            </div>

        </div>
    </section>

    <section class="page" id="page-password">
        <div style="text-align:right; padding-bottom:10px;">
            <span onclick="cancelPassword()" style="font-size:14px; color:#888; cursor:pointer;">Ï∑®ÏÜå</span>
        </div>

        <div class="pin-container">
            <div class="pin-message" id="pin-message-text">
                ÌôçÍ∏∏ÎèôÎãòÍªò<br>50,000KRWÎ•º ÏÜ°Í∏àÌï©ÎãàÎã§.
            </div>

            <div class="pin-display" id="pin-display">
                <div class="pin-dot"></div>
                <div class="pin-dot"></div>
                <div class="pin-dot"></div>
                <div class="pin-dot"></div>
                <div class="pin-dot"></div>
                <div class="pin-dot"></div>
            </div>

            <div class="num-pad">
                <div class="num-key" onclick="onKeyClick(1)">1</div>
                <div class="num-key" onclick="onKeyClick(2)">2</div>
                <div class="num-key" onclick="onKeyClick(3)">3</div>
                <div class="num-key" onclick="onKeyClick(4)">4</div>
                <div class="num-key" onclick="onKeyClick(5)">5</div>
                <div class="num-key" onclick="onKeyClick(6)">6</div>
                <div class="num-key" onclick="onKeyClick(7)">7</div>
                <div class="num-key" onclick="onKeyClick(8)">8</div>
                <div class="num-key" onclick="onKeyClick(9)">9</div>
                <div class="num-key empty"></div>
                <div class="num-key" onclick="onKeyClick(0)">0</div>
                <div class="num-key" onclick="onDeleteClick()"><i class="fas fa-backspace"></i></div>
            </div>
        </div>
    </section>

    <section class="page" id="page-success">
        <div class="success-container">
            <div class="success-icon"><i class="fas fa-check"></i></div>
            <div class="success-title" id="success-title">ÏÜ°Í∏à ÏôÑÎ£å!</div>
            <div class="success-desc" id="success-desc">Ï†ïÏÉÅÏ†ÅÏúºÎ°ú Ï≤òÎ¶¨ÎêòÏóàÏäµÎãàÎã§.</div>

            <div class="success-btns">
                <button class="btn-share" onclick="shareTransaction()"><i class="fas fa-share-alt"></i> Í≥µÏú†ÌïòÍ∏∞</button>
                <button class="btn-complete" onclick="finishTransaction()">ÏôÑÎ£å</button>
            </div>
        </div>
    </section>

    <section class="page" id="page-remit">
        <a class="back-link" data-target="page-home"><i class="fas fa-arrow-left"></i> ÌôàÏúºÎ°ú</a>
        <div class="form-card">
            <h2 style="margin-top:0;">ÌôòÏ†Ñ Î∞è Ìï¥Ïô∏ ÏÜ°Í∏à</h2>
            <p style="color:var(--sub-text-color); margin-top:4px;">Ïã§ÏãúÍ∞Ñ ÌôòÏú®Ïù¥ Ï†ÅÏö©ÎêòÎ©∞ ÏàòÏàòÎ£åÍ∞Ä Î∂ÄÍ≥ºÎê©ÎãàÎã§.</p>
            <div class="input-group">
                <label for="remit-amount">Î≥¥ÎÇº Í∏àÏï° (‚Ç©)</label>
                <input type="number" id="remit-amount" min="0" inputmode="numeric" placeholder="Ïòà: 100000">
            </div>
            <div class="input-group">
                <label for="remit-currency">Î∞õÏùÑ ÌÜµÌôî</label>
                <select id="remit-currency">
                    <option value="USD">USD (ÎØ∏Íµ≠ Îã¨Îü¨)</option>
                    <option value="EUR">EUR (Ïú†Î°ú)</option>
                    <option value="JPY">JPY (ÏùºÎ≥∏ Ïóî)</option>
                </select>
            </div>
            <button class="btn primary" onclick="submitRemit()"><i class="fas fa-globe"></i> ÏÜ°Í∏àÌïòÍ∏∞</button>
        </div>
    </section>

</div> 

<div class="bottom-nav">
    <div class="nav-item active" data-target="page-home"><i class="fas fa-home"></i> Ìôà</div>
    <div class="nav-item" data-target="page-history"><i class="fas fa-list-alt"></i> ÎÇ¥Ïó≠</div>
    <div class="nav-item" data-target="page-cards"><i class="fas fa-credit-card"></i> Ïπ¥Îìú</div>
    <div class="nav-item" data-target="page-all"><i class="fas fa-bars"></i> Ï†ÑÏ≤¥</div>
</div>

<div id="charge-bottom-bar" class="bottom-floating-bar hidden" onclick="finalCharge()">
    <span id="bottom-charge-amount">0</span>Ïõê Ï∂©Ï†ÑÌïòÍ∏∞
</div>

<div class="toast" id="toast"></div>

<script>
    // ==========================================
    // Ïï± Îç∞Ïù¥ÌÑ∞ Î∞è ÏÉÅÌÉú Í¥ÄÎ¶¨
    // ==========================================
    const state = {
        totalAssetsKRW: 5000000,
        // Í±∞Îûò ÎÇ¥Ïó≠ Îç∞Ïù¥ÌÑ∞ (paymentMethod Ï∂îÍ∞Ä: 'card', 'applepay', 'transfer' Îì±)
        transactions: [
            { id: 1, type: 'income', category:'Transfer', title: 'Mathias Bee', date: '29 Jul, 5:00pm', amount: 520000, status: 'Received', avatarUrl: 'https://randomuser.me/api/portraits/men/32.jpg', paymentMethod:'transfer', note:'' },
            { id: 2, type: 'expense', category:'Transport', title: 'Uber Ride', date: '24 Jul, 10:50pm', amount: 26000, status: 'Paid', avatarIcon: 'fab fa-uber', avatarBg: '#000', avatarColor: '#fff', paymentMethod:'applepay', note:'' },
            { id: 3, type: 'income', category:'Transfer', title: 'John Doe', date: '30 Jun, 5:00am', amount: 4500000, status: 'Received', avatarInitial: 'JD', avatarBg: '#FCE4EC', avatarColor: '#C2185B', paymentMethod:'transfer', note:'' },
            { id: 4, type: 'expense', category:'Shopping', title: 'Amazon', date: '26 Jun, 10:30am', amount: 420000, status: 'Paid', avatarIcon: 'fab fa-amazon', avatarBg: '#fff', avatarColor: '#333', paymentMethod:'card', note:'' },
            { id: 5, type: 'expense', category:'Eating Out', title: 'Ayomide OA', date: '30 Jun, 8:20pm', amount: 30500, status: 'Sent', avatarUrl: 'https://randomuser.me/api/portraits/women/44.jpg', paymentMethod:'transfer', note:'' }
        ]
    };
    
    // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú Í±∞Îûò (ÏÉÅÏÑ∏Î≥¥Í∏∞Ïö©)
    let currentDetailTxId = null;

    // ÌòÑÏû¨ ÌïÑÌÑ∞ ÏÉÅÌÉú
    let activeFilter = {
        type: null, 
        category: null, 
        sortDate: 'desc' 
    };

    // Ïπ¥ÌÖåÍ≥†Î¶¨ ÏãúÌä∏ Î™®Îìú ('filter' or 'edit')
    let categorySheetMode = 'filter';

    const exchangeRates = { 
        USD: 1300, 
        EUR: 1400, 
        AUD: 850,
        JPY: 900 
    };

    let transactionContext = { type: '', amount: 0, recipient: '' };
    let currentPin = "";

    function renderBalance() {
        document.getElementById('total-assets').innerText = '‚Ç©' + state.totalAssetsKRW.toLocaleString();
    }

    // ==========================================
    // ÎÇ¥Ïó≠ Î†åÎçîÎßÅ
    // ==========================================
    function renderHistory() {
        const list = document.getElementById('history-list');
        list.innerHTML = ''; 

        let filtered = state.transactions.filter(t => {
            if (activeFilter.type && t.type !== activeFilter.type) return false;
            if (activeFilter.category && t.category !== activeFilter.category) return false;
            return true;
        });

        if (activeFilter.sortDate === 'asc') filtered.sort((a, b) => a.id - b.id);
        else filtered.sort((a, b) => b.id - a.id);

        filtered.forEach(t => {
            const li = document.createElement('li');
            li.className = 'transaction-item';
            li.onclick = () => openTransactionDetail(t.id); 
            
            let avatarHtml = '';
            if (t.avatarUrl) {
                avatarHtml = `<div class="t-avatar" style="background-image:url('${t.avatarUrl}')"><span class="badge-nexus">N</span></div>`;
            } else if (t.avatarIcon) {
                avatarHtml = `<div class="t-avatar" style="background-color:${t.avatarBg||'#eee'}; color:${t.avatarColor||'#333'}"><i class="${t.avatarIcon}"></i></div>`;
            } else if (t.avatarInitial) {
                avatarHtml = `<div class="t-avatar" style="background-color:${t.avatarBg||'#eee'}; color:${t.avatarColor||'#333'}">${t.avatarInitial} <span class="badge-nexus">N</span></div>`;
            } else {
                 avatarHtml = `<div class="t-avatar" style="background-color:#eee; color:#333"><i class="fas fa-coins"></i></div>`;
            }

            const isIncome = t.type === 'income';
            const sign = isIncome ? '+' : '-';
            const amountClass = isIncome ? 't-amount income' : 't-amount';

            // [NEW] Apple Pay Logo Logic for List
            let titleHtml = t.title;
            if (t.paymentMethod === 'applepay') {
                titleHtml += ` <span class="apple-pay-badge"><i class="fab fa-apple"></i><span>Pay</span></span>`;
            }

            li.innerHTML = `
                <div class="t-left">
                    ${avatarHtml}
                    <div class="t-info">
                        <span class="t-title">${titleHtml}</span>
                        <span class="t-date">${t.date} &middot; <small>${t.category}</small></span>
                    </div>
                </div>
                <div class="t-right">
                    <span class="${amountClass}">${sign} ‚Ç©${t.amount.toLocaleString()}</span>
                    <span class="t-status">${t.status}</span>
                </div>
            `;
            list.appendChild(li);
        });
    }

    // ==========================================
    // ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄ Î°úÏßÅ
    // ==========================================
    function openTransactionDetail(txId) {
        const tx = state.transactions.find(t => t.id === txId);
        if (!tx) return;
        currentDetailTxId = txId;

        document.getElementById('detail-amount').innerText = (tx.type === 'income' ? '+' : '-') + ' ‚Ç©' + tx.amount.toLocaleString();
        document.getElementById('detail-amount').style.color = tx.type === 'income' ? 'var(--income-color)' : 'var(--expense-color)';
        document.getElementById('detail-title').innerText = tx.title;
        document.getElementById('detail-category').innerText = tx.category;
        document.getElementById('detail-when').innerText = tx.date;
        document.getElementById('detail-where').innerText = tx.title;

        const paidViaEl = document.getElementById('detail-paid-via');
        if (tx.paymentMethod === 'applepay') {
            paidViaEl.innerHTML = `<div class="payment-method-box"><span class="apple-pay-badge"><i class="fab fa-apple"></i><span>Pay</span></span></div>`;
        } else if (tx.paymentMethod === 'card') {
            paidViaEl.innerHTML = `<div class="payment-method-box"><div class="pm-card-icon"></div> 9876</div>`;
        } else {
             paidViaEl.innerHTML = `<div class="payment-method-box">Transfer</div>`;
        }

        renderNote(tx);
        navigate('page-transaction-detail');
    }

    function renderNote(tx) {
        const noteArea = document.getElementById('detail-note-area');
        if (tx.note) {
            noteArea.innerHTML = `<span class="note-content">${tx.note}</span>`;
        } else {
            noteArea.innerHTML = `<span class="note-add-link" onclick="openNoteSheet()">Add</span>`;
        }
    }

    // --- Note Logic ---
    function openNoteSheet() {
        document.getElementById('note-input').value = '';
        document.getElementById('note-sheet').classList.add('open');
        document.getElementById('note-overlay').style.display = 'block';
        setTimeout(() => document.getElementById('note-overlay').style.opacity = 1, 10);
    }
    
    function closeNoteSheet() {
        document.getElementById('note-sheet').classList.remove('open');
        document.getElementById('note-overlay').style.opacity = 0;
        setTimeout(() => document.getElementById('note-overlay').style.display = 'none', 300);
    }

    function saveNote() {
        const val = document.getElementById('note-input').value;
        if (!val) return;
        
        const tx = state.transactions.find(t => t.id === currentDetailTxId);
        if (tx) {
            tx.note = val;
            renderNote(tx);
            closeNoteSheet();
            showToast('Î©îÎ™®Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
        }
    }

    // ==========================================
    // ÌïÑÌÑ∞ & Ïπ¥ÌÖåÍ≥†Î¶¨ Î°úÏßÅ (ÌÜµÌï©)
    // ==========================================
    function applyFilter(filterType) {
        activeFilter.category = null;
        updateFilterUI();
        if (activeFilter.type === filterType) {
            activeFilter.type = null; 
        } else {
            activeFilter.type = filterType; 
        }
        renderHistory();
        updateFilterUI();
    }

    function toggleSortDate() {
        activeFilter.sortDate = activeFilter.sortDate === 'desc' ? 'asc' : 'desc';
        renderHistory();
        updateFilterUI();
    }

    function openCategorySheet(mode) {
        categorySheetMode = mode;
        document.getElementById('category-sheet').classList.add('open');
        document.getElementById('category-overlay').style.display = 'block';
        setTimeout(() => document.getElementById('category-overlay').style.opacity = 1, 10);
    }

    function closeCategorySheet() {
        document.getElementById('category-sheet').classList.remove('open');
        document.getElementById('category-overlay').style.opacity = 0;
        setTimeout(() => document.getElementById('category-overlay').style.display = 'none', 300);
    }

    function handleCategorySelect(catName) {
        if (categorySheetMode === 'filter') {
            activeFilter.type = null;
            activeFilter.category = catName;
            closeCategorySheet();
            renderHistory();
            updateFilterUI();
        } else if (categorySheetMode === 'edit') {
            const tx = state.transactions.find(t => t.id === currentDetailTxId);
            if (tx) {
                tx.category = catName;
                document.getElementById('detail-category').innerText = catName;
                renderHistory(); 
                closeCategorySheet();
                showToast('Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.');
            }
        }
    }

    function resetFilters() {
        activeFilter = { type: null, category: null, sortDate: 'desc' };
        renderHistory();
        updateFilterUI();
    }

    function updateFilterUI() {
        const btnIncome = document.getElementById('btn-filter-income');
        const btnExpense = document.getElementById('btn-filter-expense');
        const btnDate = document.getElementById('btn-filter-date');
        const btnCat = document.getElementById('btn-filter-category');

        btnIncome.classList.toggle('active', activeFilter.type === 'income');
        btnExpense.classList.toggle('active', activeFilter.type === 'expense');
        
        btnDate.innerHTML = `Date <i class="fas fa-sort-${activeFilter.sortDate === 'asc' ? 'up' : 'down'}"></i>`;
        
        if (activeFilter.category) {
            btnCat.innerText = activeFilter.category;
            btnCat.classList.add('active');
        } else {
            btnCat.innerText = 'Category';
            btnCat.classList.remove('active');
        }
    }

    function getFormattedDate() {
        const now = new Date();
        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        let hour = now.getHours();
        const ampm = hour >= 12 ? 'pm' : 'am';
        hour = hour % 12;
        hour = hour ? hour : 12;
        const min = now.getMinutes().toString().padStart(2, '0');
        return `${now.getDate()} ${months[now.getMonth()]}, ${hour}:${min}${ampm}`;
    }

    // ==========================================
    // ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò
    // ==========================================
    function navigate(targetId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        const targetPage = document.getElementById(targetId);
        if(targetPage) targetPage.classList.add('active');
        
        const bottomNav = document.querySelector('.bottom-nav');
        const mainPages = ['page-home', 'page-history', 'page-cards', 'page-all'];
        
        if (mainPages.includes(targetId)) {
            bottomNav.classList.remove('hidden');
        } else {
            bottomNav.classList.add('hidden');
        }

        document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
        const activeNav = document.querySelector(`.nav-item[data-target="${targetId}"]`);
        if (activeNav) activeNav.classList.add('active');
        
        if (targetId === 'page-charge') resetCharge();
        if (targetId === 'page-transfer') resetTransfer();
        
        document.getElementById('charge-bottom-bar').classList.add('hidden');
        window.scrollTo(0,0);
    }

    function showToast(msg) {
        const t = document.getElementById('toast');
        t.innerText = msg;
        t.style.display = 'block';
        setTimeout(() => t.style.opacity = 1, 10);
        setTimeout(() => {
            t.style.opacity = 0;
            setTimeout(() => t.style.display = 'none', 300);
        }, 2000);
    }

    // ==========================================
    // Í∏∞ÌÉÄ Î°úÏßÅ
    // ==========================================
    function filterTransactions(val) {
        const list = document.getElementById('history-list');
        const items = list.getElementsByTagName('li');
        const searchVal = val.toLowerCase();
        for (let item of items) {
            const name = item.querySelector('.t-title').innerText.toLowerCase();
            item.style.display = name.includes(searchVal) ? 'flex' : 'none';
        }
    }

    function startPasswordFlow(type, amount, recipientName) {
        transactionContext = { type, amount, recipient: recipientName };
        currentPin = "";
        updatePinDisplay();
        const msgEl = document.getElementById('pin-message-text');
        if (type === 'transfer') {
            msgEl.innerHTML = `${recipientName}ÎãòÍªò<br>${amount.toLocaleString()}KRWÎ•º ÏÜ°Í∏àÌï©ÎãàÎã§.`;
        } else {
            msgEl.innerHTML = `${amount.toLocaleString()}KRWÎ•º<br>Ï∂©Ï†ÑÌï©ÎãàÎã§.`;
        }
        navigate('page-password');
    }

    function onKeyClick(num) {
        if (currentPin.length < 6) {
            currentPin += num;
            updatePinDisplay();
            if (currentPin.length === 6) setTimeout(checkPin, 200);
        }
    }

    function onDeleteClick() {
        if (currentPin.length > 0) {
            currentPin = currentPin.slice(0, -1);
            updatePinDisplay();
        }
    }

    function updatePinDisplay() {
        const dots = document.querySelectorAll('.pin-dot');
        dots.forEach((dot, idx) => {
            if (idx < currentPin.length) dot.classList.add('filled');
            else dot.classList.remove('filled');
        });
    }

    function checkPin() {
        showSuccessPage();
    }

    function cancelPassword() {
        navigate('page-home');
    }

    function showSuccessPage() {
        const { type, amount, recipient } = transactionContext;
        const titleEl = document.getElementById('success-title');
        const descEl = document.getElementById('success-desc');

        const newTx = {
            id: Date.now(),
            date: getFormattedDate(),
            amount: amount,
            title: recipient,
            note: '' 
        };

        if (type === 'transfer') {
            titleEl.innerText = "ÏÜ°Í∏à ÏôÑÎ£å!";
            descEl.innerText = `${recipient}ÎãòÍªò ${amount.toLocaleString()}Ïõê ÏÜ°Í∏àÎê®`;
            state.totalAssetsKRW -= amount;
            
            newTx.type = 'expense';
            newTx.category = 'Transfer';
            newTx.status = 'Sent';
            newTx.avatarInitial = recipient.charAt(0).toUpperCase();
            newTx.avatarBg = '#E0F7FA'; 
            newTx.avatarColor = '#006064';
            newTx.paymentMethod = 'transfer'; 

        } else {
            titleEl.innerText = "Ï∂©Ï†Ñ ÏôÑÎ£å!";
            descEl.innerText = `${amount.toLocaleString()}Ïõê Ï∂©Ï†Ñ ÏôÑÎ£å`;
            state.totalAssetsKRW += amount;
            
            newTx.type = 'income';
            newTx.category = 'Charge';
            newTx.status = 'Received';
            newTx.avatarIcon = 'fas fa-wallet';
            newTx.avatarBg = '#FFF3E0';
            newTx.avatarColor = '#E65100';
            newTx.paymentMethod = 'card'; 
        }
        
        state.transactions.unshift(newTx);
        renderHistory(); 
        renderBalance(); 
        navigate('page-success');
    }

    function shareTransaction() {
        const { type, amount, recipient } = transactionContext;
        let msg = "";
        if (type === 'transfer') msg = `${recipient}ÎãòÏóêÍ≤å ${amount.toLocaleString()}Ïõê ÏÜ°Í∏à ÏôÑÎ£å!`;
        else msg = `${amount.toLocaleString()}Ïõê Ï∂©Ï†Ñ ÏôÑÎ£å!`;
        alert(`[Í≥µÏú† Î©îÏãúÏßÄ Ï†ÑÏÜ°]\n${msg}`);
    }

    function finishTransaction() {
        navigate('page-home');
    }

    function selectRecipient(name, info) {
        document.getElementById('selected-recipient-name').innerText = name;
        document.getElementById('selected-recipient-info').innerText = info;
        document.getElementById('transfer-step-1').classList.add('hidden');
        document.getElementById('transfer-step-2').classList.remove('hidden');
        document.getElementById('transfer-amount').focus();
    }

    function resetTransfer() {
        document.getElementById('transfer-amount').value = '';
        document.getElementById('transfer-step-1').classList.remove('hidden');
        document.getElementById('transfer-step-2').classList.add('hidden');
    }

    function submitTransfer() {
        const val = parseInt(document.getElementById('transfer-amount').value) || 0;
        const name = document.getElementById('selected-recipient-name').innerText;
        if(val <= 0) return showToast('Í∏àÏï°ÏùÑ Ïò¨Î∞îÎ•¥Í≤å ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
        if(val > state.totalAssetsKRW) return showToast('ÏûîÏï°Ïù¥ Î∂ÄÏ°±Ìï©ÎãàÎã§');
        startPasswordFlow('transfer', val, name);
    }

    let chargeAmount = 0;
    let selectedCurrency = 'USD';
    let selectedMethod = null;

    function setCurrency(code, el) {
        if(document.getElementById('step1-area').classList.contains('disabled-area')) return;
        selectedCurrency = code;
        document.querySelectorAll('.currency-choice').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        document.getElementById('local-currency-label').innerText = `${code} (ÌòÑÏßÄ ÌÜµÌôî)`;
        calculateFromKrw(document.getElementById('charge-krw-input').value);
    }

    function addMoney(val) {
        if(document.getElementById('step1-area').classList.contains('disabled-area')) return;
        let currentVal = parseInt(document.getElementById('charge-krw-input').value) || 0;
        let newVal = currentVal + val;
        document.getElementById('charge-krw-input').value = newVal;
        calculateFromKrw(newVal);
    }

    function calculateFromKrw(val) {
        chargeAmount = parseInt(val) || 0;
        const rate = exchangeRates[selectedCurrency] || 1300;
        const localVal = chargeAmount / rate;
        document.getElementById('charge-local-input').value = localVal > 0 ? localVal.toFixed(2) : '';
        document.getElementById('bottom-charge-amount').innerText = chargeAmount.toLocaleString();
    }

    function resetCharge() {
        chargeAmount = 0;
        selectedMethod = null;
        document.getElementById('charge-krw-input').value = '';
        calculateFromKrw(0);
        document.getElementById('step1-area').classList.remove('disabled-area');
        document.getElementById('charge-action-row').style.display = 'flex';
        document.getElementById('step2-area').classList.add('hidden');
        document.getElementById('charge-bottom-bar').classList.add('hidden');
        document.querySelectorAll('.payment-option').forEach(o => o.classList.remove('selected'));
        document.querySelectorAll('.detail-box').forEach(box => box.classList.remove('show'));
    }

    function goNextStep() {
        if (chargeAmount < 10000) {
            alert('ÏµúÏÜå 10,000Ïõê Ïù¥ÏÉÅ Ï∂©Ï†Ñ Í∞ÄÎä•Ìï©ÎãàÎã§.');
            return;
        }
        document.getElementById('step1-area').classList.add('disabled-area');
        document.getElementById('charge-action-row').style.display = 'none';
        document.getElementById('step2-area').classList.remove('hidden');
        document.getElementById('charge-bottom-bar').classList.remove('hidden');
    }

    function selectMethod(el, methodKey) {
        document.querySelectorAll('.payment-option').forEach(o => o.classList.remove('selected'));
        document.querySelectorAll('.detail-box').forEach(box => box.classList.remove('show'));
        el.classList.add('selected');
        selectedMethod = methodKey;
        if (methodKey === 'cash') document.getElementById('barcode-detail').classList.add('show');
        else if (methodKey === 'card') {
            document.getElementById('card-detail').classList.add('show');
            document.querySelector('input[name="card_select"][value="9334"]').checked = true;
            toggleCardMode('saved');
        }
    }

    function toggleCardMode(mode) {
        const newCardForm = document.getElementById('new-card-form');
        newCardForm.style.display = (mode === 'new') ? 'block' : 'none';
    }

    function finalCharge() {
        if (!selectedMethod) return showToast('Í≤∞Ï†ú ÏàòÎã®ÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
        if (selectedMethod === 'card') {
            const cardSelection = document.querySelector('input[name="card_select"]:checked').value;
            if (cardSelection === 'new') {
                const inputs = document.querySelectorAll('#new-card-form input');
                for(let input of inputs) if(!input.value) return alert('Ïπ¥Îìú Ï†ïÎ≥¥Î•º Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
            }
        }
        startPasswordFlow('charge', chargeAmount, 'ÎÇ¥ ÏßÄÍ∞ë');
    }

    function submitRemit() {
        const val = parseInt(document.getElementById('remit-amount').value) || 0;
        if(val <= 0) return showToast('Í∏àÏï°ÏùÑ Ïò¨Î∞îÎ•¥Í≤å ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
        if(val > state.totalAssetsKRW) return showToast('ÏûîÏï°Ïù¥ Î∂ÄÏ°±Ìï©ÎãàÎã§');

        state.totalAssetsKRW -= val;
        renderBalance();
        showToast('ÌôòÏ†Ñ Ïã†Ï≤≠Ïù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.');
        document.getElementById('remit-amount').value = '';
        navigate('page-home');
    }

    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('[data-target]').forEach(el => {
            el.addEventListener('click', (e) => {
                const target = el.dataset.target;
                navigate(target);
            });
        });
        resetCharge();
        renderBalance();
        renderHistory(); 
    });

</script>

</body>
</html>